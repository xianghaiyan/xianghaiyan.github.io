---
layout:     post
title:      "解读银联跨行清算系统"
subtitle:   "本文将对央行的亲儿子银联的跨行清算系统做详细地介绍及解读"
date:       2017-03-08
author:     "Petrel Xiang"
header-img: "img/post-bg-js-version.jpg"
tags:
    - 银联跨行清算系统
    - 架构
---

# 前言

目前实现跨行清算的系统主要有银联跨行清算系统、第三方支付系统、人行的网上支付跨行清算系统（超级网银），本文主要介绍银联的跨行清算系统。

# 跨行清算业务与清算对象
首先从业务上讲，银联的支付清算包括清分和资金划拨两个环节。清分是指对交易日志中记录的成功交易，逐笔计算交易本金及交易费用（手续费、分润等），然后按清算对象汇总扎差习惯应收或应付金额，简言之，就是搞清楚今天应该向谁要多少钱，应该给谁多少钱；资金划拨是指通过特定的渠道和方式，完成应收应付资金的转移，简言之，就是明确通过何种渠道，拿回应收款、付出应付款。

银联的支付清算包括跨行清算和收单清算，二者的对象不同：跨行清算是针对收单机构和发卡机构的清算；收单清算是代替收单机构针对商户和收单专业化服务机构的清算。

![java-javascript](/img/in-post/post-Unionpay/1.jpg)
<small class="img-hint">银联跨行清算系统</small>

# 清算资金的划拨方式

境内的跨行清算通过人行的大额支付清算系统完成资金划拨，银联可以主动借记或贷记成员机构的清算账户，通俗的将，借记就是我向别人要钱，贷记就是我给别人钱；境外的跨行清算通过银联代理清算银行（中行和汇丰），通过银行与银行直接的结算汇兑系统完成，但目前只能实现贷记结算；境内的收单清算可以通过人行的小额支付清算系统完成资金划拨，部分分公司保留通过当地人行票据交换系统完成资金划拨，但均只能实现贷记结算。

# 对账方式

对账方式根据自主清算和非自主清算进行区分。境内的跨行清算和收单清算均采用自主清算，相应的对账方式是先以银联清分结果为准，先行办理资金划拨，然后成员机构、第三方机构或商户再根据银联的对账文件，对比本身的交易明细，如果有错误就通过差错方式处置；外卡收单清算及部分跨境业务均采用非自主清算。

# 银联清算系统与大小额支付的关系

无论是跨行清算还是收单清算，银联都是作为一个特许参与者，加入大小额支付清算系统，完成银行卡交换业务的资金划拨。银联通过大额支付系统，实现境内成员机构清算账户之间的双向资金转移；银联通过小额支付系统和当地票据交换系统，实现与境内第三方机构和商户之间的单向资金转移。

在大额支付清算系统中，银联享有比商业银行更大的特权，因为银联可以借记或贷记对方的账户，商业银行只能贷记对方的账户。在大额支付清算系统中还享有借记特权的只有国债登记公司，而且其借记操作还需要国债作抵押。

# 场景案例说明

**张三是工行的持卡人，他需要取现金，但是找不到工行的ATM机器，发现附近有建行的ATM机器，他只能去建行取款，整个过程就是跨行清算的过程，我们以这个场景为例，分析一下业务流程，具体交互流程见下面一张图。**

![java-javascript](/img/in-post/post-Unionpay/2.jpg)
<small class="img-hint">跨行取款流程</small>

以上的结构，很关键的一点是不同银行间如何进行通信。如果银行直接与银行开发接口，那n家银行就要有n*(n-1)个接口线路，显然是非常不经济且复杂的。可以通过两种方式显示： 

* 公共接口模式：定义通信网络定义标准接口，所有的银行都必须实现这个通信网络定义的api，新的银行如果想要接入这个通信网络，必须实现通信接口约定的协议。

* 适配器模式：通信网络主动去连接所有的银行的接口，把所有银行的接口信息都接入里面，就像一个适配器，新的银行如果想要接入这个通信网络，这个通信网络必须主动联系银行，按照银行的接口协议实现通信。

对于这两模式，主要博弈就在于谁强谁弱。显然第三方支付公司属于适配器模式，需要一家一家银行去接入，银联应该是第一种模式，这种对于银联这种需要稳定的系统来说是最具有优势的。

此外，就是如果跨行之间每笔交易都实时清算，那交易量太大，而且可能涉及到两个银行之间的频繁资金划转,，对最终清算的人行系统压力也会很大，例如日间如果发生：

1. A用户从工行ATM支取建行卡200元；
2. B用户从建行ATM支取工行卡100元；
3. C用户从建行ATM支取工行卡150元；

实际上只需要发生交易时工行和建行进行记账，日末工行统一转账给建行50元即可。

为了保障扎差资金划转时每个银行有足够的资金进行清算，各接入行需要再人行开立备付金账户，同时各银行会在内部开立相应的虚拟账户对应在人行的备付金账户，以便时候对账。

最后对于前面账户在建行ATM机取工行卡100元的案例，处理流程为：

1. 系统T日发生建行和工行的跨行交易100

![java-javascript](/img/in-post/post-Unionpay/3.jpg)
<small class="img-hint">跨行交易结算1</small>

2. 清算系统T+1日汇总T日工行和建行之间发生的交易明细数据，并且发这些数据发给建行和工行进行确认

![java-javascript](/img/in-post/post-Unionpay/4.jpg)
<small class="img-hint">跨行交易结算2</small>


3. 工行建行分别对明细对账确认之后，通知清算系统确认交易明细无误，清算系统开始清算，调用备付金支付系统转账
4. 清算完成之后，工行和建行分别获取备付金系统的真实金额和自身系统内部的映射账户进行余额对账（对账包括两个部分，一个是跨行交易明细的对账以及备付金余额的对账）

![java-javascript](/img/in-post/post-Unionpay/5.jpg)
<small class="img-hint">跨行交易结算3</small>

# 清分清算流程
清分清算主要有3个关键点：扎差清分、两级清算；支付系统、集中处理；日切，划分交易时间。

![java-javascript](/img/in-post/post-Unionpay/6.jpg)
<small class="img-hint">清分清算流程</small>

![java-javascript](/img/in-post/post-Unionpay/7.jpg)
<small class="img-hint">整体的系统结构图</small>

支付清算体系是一个国家的金融基础设施，或说公共服务。我国由央行主管此事，目前大体维持“结算-清算”二级制的支付体系。通俗地讲，银行与商户、消费者之间为结算关系，而银行之间构成清算关系，两个层次交易完成后，支付环节才算终了。清算，其实就是因跨行交易而产生的银行间债务债权进行定期净轧（比如每日），以结清因跨行交易产生的债务债权。清算更为底层，是一个平台，由央行主导建设，一般个人用户不会直接接触清算系统。结算则是前端，由银行、非金支付公司等向客户提供服务，也就是所谓的支付业务。银行自身接入清算系统，非金融支付公司则以自已开户的备付金托管行代理，接入清算系统。


  