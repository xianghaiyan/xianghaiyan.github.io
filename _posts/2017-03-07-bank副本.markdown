---
layout:     post
title:      "清算与清分"
subtitle:   "本文详细介绍了中国的支付清算体系及大小额交易系统"
date:       2017-03-07
author:     "Petrel Xiang"
header-img: "img/post-bg-js-version.jpg"
tags:
    - 清算
    - 清分
---
随着负责的产品越来越多，慢慢地接触到了支付公司的核心-订单系统、支付系统、认证系统、账务系统、路由系统、银行子系统、打款子系统、对账子系统、商户通知等。过程中就避免不了和银行打交道。

于是，了解银行的清结算就成为迫切需求。在网络的强大支持下，我整理了相关的知识，用于自我学习和分享。

---
# 支付清算体系的简介

支付清算体系是一个国家的金融基础设施，或说公共服务。我国由央行主管此事，目前大体维持“**结算-清算**”二级制的支付体系。**通俗地讲，银行与商户、消费者之间为结算关系，而银行之间构成清算关系，两个层次交易完成后，支付环节才算终了。清算，其实就是因跨行交易而产生的银行间债务债权进行定期净轧（比如每日），以结清因跨行交易产生的债务债权。**清算更为底层，是一个平台，由央行主导建设，一般个人用户不会直接接触清算系统。结算则是前端，由银行、非金支付公司等向客户提供服务，也就是所谓的支付业务。**银行自身接入清算系统，非金融支付公司则以自已开户的备付金托管行代理，接入清算系统。**

![java-javascript](/img/in-post/post-qinsuan/1.jpg)
<small class="img-hint">”结算-清算”二级体系</small>

  从上面的二级体系可以看出，跨行的清算必须经过央行的清算系统进行处理，而银行内部的结算，则是由各个商业银行自己经营办理。

在《中国人民银行法》中规定了中国人民银行对清算的义务和责任：

1. 中国人民银行应当组织或者协助组织银行业金融机构相互之间的清算系统，协调银行业金融机构相互之间的清算事项，提供清算服务，具体办法由中国人民银行制定。
2. 中国人民银行会同国务院银行业监督管理机构（银监会）制定支付结算规则。
3. 在《商业银行法》中规定了商业银行对结算的支持：
4. 商业银行可以经营办理国内外结算。

 因此，清算不等于结算。从基础概念看，央行主导了银行业金融机构之间的清算系统，而商业银行则可以经营国内外结算业务，即是“结算-清算”二级制的支付体系。

那么，为什么央行需要维持目前的“结算-清算”二级体系呢？笔者认为本质是监控资金在全社会的流动，避免系统性风险，提高支付的效率，树立公众对支付体系的信心，同时，有利于有效地实施货币政策等。由于清算系统是平台系统，不是前端服务，因此对用户体验没有刻意要求，但对系统稳定性、可靠性、高效性、安全性要求极高，央行将其视为金融的基础设施，或称公共服务，依然未允许市场化的商业介入。结算环节则是市场主体分散的交易，对用户体验要求较高，因此在不产生系统性风险（要一定程度上容忍非系统性风险，比如创新业务试点中发现安全漏洞之类的）的前提下，当局鼓励创新，增加用户支付效率，改进体验。因此，我们认为，央行希望实现的意图为维持现有格局，清算环节仍然视为基础设施，不希望市场介入；支付结算环节则放开竞争，鼓励创新。

目前在运行的清算系统均由央行主管，主要包括**大额实时支付系统、小额批量支付系统、网上支付跨行清算系统（超级网银）、同城票据清算系统、境内外币支付系统、全国支票影像交换系统、银行业金融机构行内支付系统、银行卡跨行支付系统（银联跨行交易清算系统CUPS）、城市商业银行资金清算系统和农信银支付清算系统等。**这些系统大多由央行主办，可视为非盈利的基础设施，仅银行卡跨行支付系统由特许企业（银联）运营（但银联仍由央行主管）。

# 清算的运作过程

本节以银联为例子，结合目前的刷卡消费涉及的发卡行，收单行，衔接机构，用户和商户等主体，全面阐述清算的过程。

## 1. 清算账户的开通

清算进行的前提条件是参与清算的主体需要开通清算账户，用于管理清算过程中形成的债权债务沉淀，管理资金的头寸。

首先接入相关清算系统的主体需要在清算系统开清算账户，银行一般需要在央行开通准备金账户和备付金账户（主要用于清算），银联则只需要在央行开通备付金账户即可，无需准备金账户。

##### 而商户对接银联的清算则有两种接入模式：

* **直联商户**：即直接通过银联的POS接入商户，商户的交易过程会经过银联网络，且其清算过程是由银联的收单清算系统进行处理，直联商户的结算账户（不在央行清算系统开清算账户，只是在商业银行开结算账户而已）一般不是开在央行的清算系统，而是开在一般商业银行中，银联通过对应的小额系统对其结算账户进行贷记处理。

* **间联商户**：是由收单行自己布置POS对接的商户，商户的交易过程一般对银联来说是透明的，其清算过程，或者说应该是结算过程是由对应的收单行跟各个商户自己进行的，银联不参与其中的结算。

![java-javascript](/img/in-post/post-qinsuan/2.jpg)
<small class="img-hint">”银联清算系统</small>

从上图可以看出，清算账户和结算账户不是一个概念，清算账户是开在央行对应的清算系统中，而结算账户一般是开在商业银行。具体：

* 银联境内清算账户均开在中国人民银行，跨境业务的清算账户开在代理清算银行（一般是中行和汇丰银行）

* 境内成员机构（即参与银行卡交易的银行）的清算账户均开立在中国人民银行，银行一般在人民银行开立有准备金账户和备付金账户，清算一般使用备付金账户进行。

* 境内商户和第三方支付机构的结算账户均开立在商业银行中。

##### 这里也说一下银联清算系统和银联会计核算系统的关系：

* 银联清算系统处理的对象是银行卡跨行交易的清算资金。

* 银联会计核算系统处理的是银联的自有资金，其中的自有资金中包括了银联自己清算账户上的资金余额，会计核算系统是按照企业会计准则，使用总分户账，登记账户变动和资金转移的信息，而银联清算系统仅仅是建立了清算资金的台账信息。

![java-javascript](/img/in-post/post-bank/银联清算系统.jpg)
<small class="img-hint">”银联清算系统</small>

## 二、清算的执行过程

###### 《支付清算组织管理办法》规定：

* 支付清算是指支付指令的交换和计算；

* 支付指令是指参与者以纸质，磁介质或者电子形式发出的，办理确定金额的资金转账命令；

* 支付指令的交换是指提供专用的支付指令传输路径，用于支付指令的接收，清分，和发送。

* 支付指令的计算是指对支付指令进行汇总和扎差；

* 参与者是指接受支付清算组织章程制约，可以发送，接收支付指令的金融机构及其其他机构。
因此，清算的执行过程主要分为清分和资金划拨两个阶段。

##### 1. 什么是清分？

是指对联机交易系统中的交易日志中记录成功的交易，逐笔计算交易本金和交易的费用（如手续费，利润分成等），然后按清分对象汇总扎差形成对各个清分对象的应收或者应付金额的过程。直白说，就是通过交易日志计算搞清楚今天应该给谁多少钱和应该向谁要多少钱。

##### 2. 什么是资金划拨？

是指完成了清分后，已经搞清楚了应该给谁多少钱或者向谁要多少钱以后，需要通过特定的渠道和方式，完成应收应付资金的转移。简单的说，就是明确通过何种渠道，拿回应收的钱，付出应付的钱。

![java-javascript](/img/in-post/post-bank/银联清算系统.jpg)
<small class="img-hint">清算系统模块</small>

 从上图可以看到，清分的数据一般是先从联机交易系统获取交易日志到清算系统，然后根据交易成功的交易日志按照清分对象汇总扎差形成各个清分对象的债权债务关系（注意，在清分阶段，还没对各个相关清分对象的清算账户进行贷记和借记操作，贷即是需要给钱的，借是需要出钱的，清分阶段只是在清算系统内部计算当天的扎差后的债权和债务关系。

完成了清分后，就可以得出各个清分对象的当天的债权和债务关系，接下来需要对各自清算账户进行资金划拨，实现资金从债务的清算账户向债权的清算账户进行划拨。资金划拨，说白了就是资金转账，需要通过一定的清算支付系统进行：如图4中通过资金管理平台形成转账命令文件上传到统一文件收发平台，由统一文件收发平台通过调用连接央行相关清算系统的前置机接口发送到相关的清算系统对清分对象的清算账户进行借贷记录操作，并获取操作后的回导结果。

##### 3. 资金的划拨方式

* 境内的跨行清算是通过央行的大额支付清算系统，完成资金划拨。**非常核心的一点是：银联是特许企业，有权限可以主动借记或者贷记诚意机构的清算账户。直白一点是：借记就是我向别人要钱，贷记就是我给别人钱。**

* 境外的跨行清算是通过银联代理清算银行进行的，通过银行与银行直接的结算汇兑系统完成，但目前只能支持贷记结算，即只能记录我给别人的钱。

* 境内的收单清算可以通过央行的小额支付清算系统完成资金划拨，但只能是实现贷记结算。

##### 4. 银联清算系统与央行大小额支付清算系统的关系

* 无论是跨行清算还是收单清算，银联都是作为一个**特许参与者**，加入到央行的大小额支付清算系统，完成了银行卡交换业务的资金划拨。

* 银联通过央行的大额支付清算系统，实现与境内成员机构清算账户之间的**双向**资金转移（即可贷记和借记相关清算账户）

* 银联通过小额支付系统或者当地的票据交换系统，实现与境内第三方机构和直联商户之间的**单向**资金转移（即只能贷记相关清算账户）

* 在大额支付清算系统中，银联享有比商业银行更大的特权，因为银联可以借记或者贷记相关成员机构的清算账户（说白了，银联可以直接操作成员机构的清算账户：付多少或者收多少钱），而商业银行只能贷记对方的账户（即只能操作对方清算账户：收多少钱）。在大额支付清算系统中还享有借记特权的只有国债登记公司，但其借记操作还需要有国债做抵押。

从这里可以看出，借记清算账户的权限是更高的，即可以随意决定别人的清算账户对外付款，或者说直接扣别人清算账户的资金，因此只有特许企业才能有这个权限，如银联或者国债登记公司等。

##### 5. 银联清算系统与银行结算系统的关系
* 银联和商业银行都是作为参与者，加入到大小额支付清算系统，完成了跨行资金的划拨。

* 银联清算系统的清算对象是成员机构（一般是商业银行：发卡行，收单行），第三方机构和直联商户。

* 商业银行结算系统的结算对象是在本行开立存款账户的单位或者个人，并通过央行的支付清算系统，帮助存款账户持有人完成支付结算所需的资金转移（如个人跨行转账，则需借助央行的清算系统）。

* 银联在央行开立的清算账户从本质上说是备付金账户；而商业银行在央行开立的清算账户分准备金账户和备付金账户；

Ø  准备金账户主要是用于监管使用，用于保护存款人合法权益（即商业银行对吸取存款一定的比例的资金需要存到央行的准备金账户，避免银行一旦有问题，能够拿这些钱补偿存款人，当然现在也在积极探讨存款保险制度）；而备付金账户主要用于自身的资金头寸的管理。

## 三、清算的对账

涉及到资金扭转的系统，都需要进行对账。各个清分对象需要进行对账：清分对象自己都会记录交易信息，然后用自己记录的交易日志跟清算系统进行复式（双向）对账，那么对账面临的一个问题是：以谁的数据为准的问题。

对账方式分为：自主清算和非自主清算。简言之，自主清算就是以我数据为准的清算，非自主清算就是不是以我数据为准的清算。

境内的跨行清算和收单清算均采用了自主清算，其相应的对账方式是先以银联的清分结果为准，先行办理资金划拨，然后成员机构，第三方机构或者直联商户，再根据银联的对账文件，对比自身的交易明细，如果有出入就通过差错方式处理。

外卡收单清算以及部分跨境业务均采用非自主清算。

接下来以两个例子为重点，全面剖析整个清算的过程。

##### 1. 记账原则

在会计学上，需要分清楚一个概念：会计主体，简言之，就是会计信息体现或者代表谁的经济利益，代表给谁做的账。做帐的人不一定是会计主体，比如替别人做帐。在参与清算的各个主体来说，他们首先需要在央行开立清算账户或者在对应的商业银行开立结算账户，对银联的清算系统来说，银联只是帮忙央行或者对应商业的清算服务提供做帐服务，这些账户在央行或者对应的商业银行应该划分为**资产负债共同类账户**比较合适，即做帐的会计主体是对应的央行或者商业银行，里面的借贷关系是代表从央行或者商业银行的角度看到的经济信息。银联只是提供做帐服务，在这样的原则下，**我们得出做帐的结论：所有清算账户或者结算账户，由于是资产负债共同类账户，负债增加记为贷，负债减少记为借。简言之：对清算账户或者结算账户，借记表示减少，即从账户扣钱，贷记表示增加，即从账户打钱。**


##### 2. 关于直联商户的清分说明

直联商户的说明见上一篇，直联商户的清分是在银联的第二次清分或者是收单清算里面处理的，直联商户不直接在央行设立清算账户，而是在某个商业银行开设结算账户，但银联对该结算账户具有贷记权限（即能够给直联商户打钱的权限），银联第一次清分即是进行跨行清算，然后在第一次清分的基础上进行二次清分，即收单清算，对挂靠其结算账户的商业银行进行二次清分，简言就是把商业银行从第一次跨行清算得到的钱再进行计算该给多少钱给直联商户和多少给到商业银行。如果没有直联商户，而是某个收单行自己布置POS对接商户，那么银联只需进行第一次的跨行清算即可，至于收单行和对应的间联商户的结算，由收单行自己进行，下面的两个例子将一起说明这两种情况。

##### 3. 手续费的比例说明

按照目前业界的规则，刷卡手续费一般是由商户出（所以大家知道去商户买东西，很多都欢迎使用现金的，甚至有些刷卡是需要消费者单独给刷卡手续费的情况），发卡行，收单行和银联的分成比例是：7：2：1。

## 四、清分的例子剖析

**1. 持卡人张三于2015年8月4日持工行借记卡，在中信银行自己布放的缴费POS终端上，成功缴了一笔200元的电费（实际是缴给电力公司A），中信银行收单，缴费交易执行交换费单笔0.10元，转接费0.05元。**

> 分析如下：

> * 该例子没有直联商户，比较简单，因此只需要进行一次清分即可，即跨行清算，无需进行二次清分（收单清算）。而商户（电力公司A）跟收单行(中信银行)之间的结算则由收单行自己负责。

> * 该例子发卡行是工行，收单行是中信银行，支付类型是缴费交易，手续费是发卡行收取0.10元，银联转接费收取0.05元，这些费用在跨行清算中，统一由收单行中信银行先行支付（至于中信银行和其对接的商户之间的结算不在本次清算中），故清分处理如下：

![java-javascript](/img/in-post/post-bank/银联清算系统.jpg)
<small class="img-hint">清分过程1</small>

> 进一步分析：

 * 收单行中信银行在跨行清算中，先出0.15元的手续费，其实是不包括自己收单行的收益的，按照收单行的收费比例0.08%，中信银行需要向对接的商户（电力公司A）收取：200元*0.08%=0.16元手续费，扣除先帮商户出的0.15元，即自己的手续费收入是0.01元，即商户在中信银行开的结算账户的记账如下：

```js
 电力公司A结算账户（对中信来说，是负债账户，增加记为贷，减少记为借)
```

```js
//CommonJS

//因为在执行这句前 Employee 模块肯定来不及加载进来
```

![java-javascript](/img/in-post/post-bank/银联清算系统.jpg)
<small class="img-hint">电力公司A的结算记账</small>

当然，由于是间联商户，因此银联不参与这块的结算过程。

**2. 持卡人李四2015年8月4日持招行贷记卡，在深圳沃尔玛商场（直联商户，工行收单）成功刷卡购物1000元。假设消费交易执行交换费0.7%，转接费0.1%，商户的扣费比例是1%。**

#####清分的分析过程如下：

 清分对象有：

招行-发卡行，工行-收单行，直联商户（深圳沃尔玛），转接行-银联。

清算账户有：

设立在央行的清算账户：招行，工行，银联。

设立在工行的结算账户：直连商户深圳沃尔玛。

##### 第一次清分（跨行清算）处理：先不考虑商户这块的清分。

**步骤1：处理消费支付部分的清分：**

![java-javascript](/img/in-post/post-bank/银联清算系统.jpg)
<small class="img-hint">消费支付部分清分记账</small>

即表示消费资金从发卡行招行到收单行工行的转移。

**步骤2：处理对应手续费的清分：**

消费交易费率：发卡行：0.7%，转接：0.1%，则发卡行和转接行分别获得手续费收益是：1000元*0.7%=7元，1000元*0.1%=1元，这些手续费第一次清分先从收单行出，即收单行付出手续费：7元+1元=8元，因此记账如下：
![java-javascript](/img/in-post/post-bank/银联清算系统.jpg)
<small class="img-hint">手续费部分清分记账</small>

合并两次的记账，得出第一次清分的汇总结果：
![java-javascript](/img/in-post/post-bank/银联清算系统.jpg)
<small class="img-hint">第一次清分汇总记账</small>
##### 第二次清分（收单清算）处理：即对收单行的资金需要在直联商户进行二次清分

跨行清算是针对收单机构（收单行）和发卡机构（发卡行）的清算；收单清算是代替收单机构针对直联商户和收单专业化服务机构的清算。

收单行收到的1000元，其实不属于收单行所有，只是代替商户（深圳沃尔玛）收款而已，另外收单行先出的8块钱手续费，也是先替商户出的，因此，在收单清算中，需要解决收单行和直联商户的资金关系。按照说明，整体手续费是由商户出的，比例是1%，即商户需要出的手续费是：1000元 *1% = 10元，其中8元是需要还收单行之前帮给的，剩下的2元是给到收单行的手续费收入。
![java-javascript](/img/in-post/post-bank/银联清算系统.jpg)
<small class="img-hint">第二次清分汇总记账</small>

下面我们对跨行清算和收单清算的账户清分进行汇总（即合并图6和7）：
![java-javascript](/img/in-post/post-bank/银联清算系统.jpg)
<small class="img-hint">二次清分汇总结果</small>


继续对各个清算账户的借贷进行相抵，计算出对应的债权和债务关系，清算账户余额=贷方累计额-借方累计额。

得出二次清分的各个账户如下：
![java-javascript](/img/in-post/post-bank/银联清算系统.jpg)
<small class="img-hint">二次清分汇总结果（各个账户扎差后）</small>

综合例子1和2，把图1和图9合并后得出当天交易对各个清算账户的清分记录如下：
![java-javascript](/img/in-post/post-bank/银联清算系统.jpg)
<small class="img-hint">当天清分结果（汇总扎差后的债权债务关系）</small>

会计恒等式验证：

借方累计：993+197.90=1190.9

贷方累计：1.05+990+199.85 =1190.9

借方 = 贷方。

资金划拨的流程

图10已经给出了当天的清分结果，通过这个结果，我们已经知道了各个清分对象在当天的债权债务关系了，接下来需要进行资金划拨，实现债权债务的清偿。

说得直白一点，就是前面的一次清分和二次清分的目的都是把账算清楚后，知道谁给给谁多少钱，谁给收谁多少钱，然后调用央行的清算系统进行资金转账-即资金划拨。
![java-javascript](/img/in-post/post-bank/银联清算系统.jpg)
<small class="img-hint">清算业务处理系统图</small>

流程说明如下：

1. 2015年8月4日（上面的交易是8月4日白天进行）晚上11：00银行卡跨行支付系统完成日切。将截止到日切时间的当天交易日志发送到银联清算系统，清算系统在8月5日凌晨首先进行跨行清算（第一次清分），然后进行收单清算（第二次清分）。

2. 8月5日上午10点左右，完成了最终的清分，将汇总的清分结果（如上图10），通过资金管理平台和连接央行清算系统的前置机发送清算指令，先借记后贷记（为什么是这样？大家可以自己思考一下），按优先级排队。

3. 通过央行的大额支付清算系统对设立在央行的备付金清算账户进行借记操作，实时完成跨行清算资金的转移（其实是先扣款，借记招行993.00元，借记工行197.90元）；通过小额批量支付系统贷记商户（直联商户-深圳沃尔玛）开立在收单行（工行）的结算账户（贷记990元，相当于是付款给深圳沃尔玛）；通过大额清算系统贷记银行和银联在央行开立的备付金清算账户，完成实时跨行及收单清算（其实是付款，贷记中信199.85元，贷记银联1.05元）。

4. 中信银行收到银联划拨的资金后，通过本行的行内结算系统，贷记间联商户（电力公司A）的结算账户（参考图2，贷记电力公司A(200-0.16=199.84元)，中信收单收益是0.01元）；工行和招行或调整持卡人的可用余额：实际上是在联机交易的时候银行已经实时扣减了持卡人的账户余额或者可用额度)




